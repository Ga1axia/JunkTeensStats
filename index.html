<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JunkTeens Stats Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Grandstander:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .font-lilita {
            font-family: 'Lilita One', cursive;
        }
        .font-grandstander {
            font-family: 'Grandstander', cursive;
        }
        .text-outline {
            -webkit-text-stroke: 1px black;
            text-stroke: 1px black;
        }
        #ti-widget-89105dc55f7b463a8656c912a46 {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            gap: 0px !important;
            width: 100% !important;
            max-width: 100% !important;
            overflow: hidden !important;
        }
        .ti-widget-container {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            gap: 0px !important;
            width: 100% !important;
            max-width: 100% !important;
        }
        .ti-review-item {
            flex: 0 0 100% !important;
            min-width: 100% !important;
            max-width: 100% !important;
            width: 100% !important;
        }
        .ti-widget {
            width: 100% !important;
            max-width: 100% !important;
        }
        .ti-review-item * {
            word-wrap: break-word !important;
            overflow-wrap: break-word !important;
            hyphens: auto !important;
            max-width: 100% !important;
            box-sizing: border-box !important;
        }
        .ti-review-content {
            overflow: visible !important;
            text-overflow: unset !important;
            white-space: normal !important;
            word-break: break-word !important;
        }
    </style>
</head>
<body class="bg-black min-h-screen">
    <!-- Main Container -->
    <div class="relative w-full min-h-screen p-4 md:p-8">
        <!-- Header Section -->
        <div class="relative w-full max-w-6xl mx-auto mb-8">
            <div class="relative h-32 md:h-52 w-full overflow-hidden border-4 border-white rounded-lg">
                <img src="12025ea9f8527bc1a6e435e663374efa4d2e24a3.png" 
                     alt="Live Stats Heading" 
                     class="absolute inset-0 w-full h-full object-cover">
            </div>
        </div>

        <!-- Stats Container -->
        <div class="w-full max-w-none mx-auto px-4">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Left Column - Daily Stats -->
                <div class="space-y-6 lg:col-span-2">
                    <!-- Today's Stats -->
                    <div class="bg-transparent border-2 border-white rounded-lg p-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
                            <div class="bg-transparent border-2 border-white rounded px-4 py-2 mb-4 md:mb-0 inline-block mx-auto md:mx-0">
                                <h2 class="font-grandstander font-bold text-white text-2xl md:text-4xl text-center">TODAY</h2>
                            </div>
                            <div class="text-right">
                                <p class="font-lilita text-white text-xl md:text-3xl underline">Sept. 23</p>
                            </div>
                        </div>
                        
                        <!-- Stats Table -->
                        <div class="overflow-x-auto border-2 border-white rounded">
                            <table class="w-full">
                                <thead>
                                    <tr class="bg-gray-500">
                                        <th class="border border-black px-2 py-2 text-left" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">TRUCK#</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">1</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">2</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">3</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">4</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">5</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">TOTAL</p>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">DAILY REV</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="daily_rev" data-truck="1" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,250</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="daily_rev" data-truck="2" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,450</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="daily_rev" data-truck="3" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,380</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="daily_rev" data-truck="4" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,320</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="daily_rev" data-truck="5" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,560</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="daily_rev" data-truck="total" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$6,960</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">CLOSE RATE</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="close_rate" data-truck="1" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">68%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="close_rate" data-truck="2" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">72%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="close_rate" data-truck="3" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">70%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="close_rate" data-truck="4" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">65%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="close_rate" data-truck="5" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">75%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="close_rate" data-truck="total" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">70%</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">RPH</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="rph" data-truck="1" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$156</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="rph" data-truck="2" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$181</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="rph" data-truck="3" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$172</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="rph" data-truck="4" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$165</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="rph" data-truck="5" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$195</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="today" data-metric="rph" data-truck="total" style="height: 50px;">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$174</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Yesterday's Stats -->
                    <div class="bg-transparent border-2 border-white rounded-lg p-6">
                        <div class="flex flex-col md:flex-row md:items-center justify-between mb-6">
                            <div class="bg-transparent border-2 border-white rounded px-4 py-2 mb-4 md:mb-0 inline-block mx-auto md:mx-0">
                                <h2 class="font-grandstander font-bold text-white text-2xl md:text-4xl text-center">YESTERDAY</h2>
                            </div>
                            <div class="text-right">
                                <p class="font-lilita text-white text-xl md:text-3xl underline">Sept. 22</p>
                            </div>
                        </div>
                        
                        <!-- Stats Table -->
                        <div class="overflow-x-auto border-2 border-white rounded">
                            <table class="w-full">
                                <thead>
                                    <tr class="bg-gray-500">
                                        <th class="border border-black px-2 py-2 text-left">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">TRUCK#</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">1</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">2</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">3</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">4</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">5</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">TOTAL</p>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">DAILY REV</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="daily_rev" data-truck="1">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,180</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="daily_rev" data-truck="2">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,350</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="daily_rev" data-truck="3">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,420</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="daily_rev" data-truck="4">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,290</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="daily_rev" data-truck="5">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$1,480</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="daily_rev" data-truck="total">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$6,720</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">CLOSE RATE</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="close_rate" data-truck="1">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">65%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="close_rate" data-truck="2">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">70%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="close_rate" data-truck="3">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">71%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="close_rate" data-truck="4">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">64%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="close_rate" data-truck="5">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">74%</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="close_rate" data-truck="total">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">69%</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">RPH</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="rph" data-truck="1">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$147</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="rph" data-truck="2">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$169</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="rph" data-truck="3">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$178</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="rph" data-truck="4">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$161</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="rph" data-truck="5">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$185</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="yesterday" data-metric="rph" data-truck="total">
                                            <p class="font-lilita text-white text-lg md:text-3xl text-outline">$168</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Right Column - Additional Stats -->
                <div class="space-y-6 lg:col-span-1">
                    <!-- Google Reviews - Match Yesterday height -->
                    <div class="bg-transparent border-2 border-white rounded-lg p-6 flex items-center justify-center" style="min-height: 352.5px;">
                        <div class="w-full flex justify-center">
                            <div id="ti-widget-89105dc55f7b463a8656c912a46" class="w-full max-w-md"></div>
                        </div>
                        <script defer async src='https://cdn.trustindex.io/loader.js?89105dc55f7b463a8656c912a46'></script>
                    </div>

                    <!-- Weekly Record Trucks - Match Yesterday height -->
                    <div class="bg-transparent border-2 border-white rounded-lg p-6">
                        <div class="text-center mb-6">
                            <div class="bg-transparent border-2 border-white rounded px-4 py-2 inline-block">
                                <h2 class="font-grandstander font-bold text-white text-xl md:text-2xl">WEEKLY RECORD TRUCKS</h2>
                            </div>
                        </div>
                        
                        <!-- Weekly Records Table -->
                        <div class="overflow-x-auto border-2 border-white rounded">
                            <table class="w-full">
                                <thead>
                                    <tr class="bg-gray-500">
                                        <th class="border border-black px-2 py-2 text-center w-16" style="height: 55px;">
                                            <p class="font-lilita text-white text-sm md:text-lg text-outline">RANK</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="width: 1.3em; height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">TRUCK#</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">REVENUE</p>
                                        </th>
                                        <th class="border border-black px-2 py-2 text-center" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">DATE</p>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2 text-center w-16" style="height: 55px;">
                                            <p class="font-lilita text-white text-sm md:text-lg text-outline">1ST</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank1_truck" style="width: 1.3em; height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">5</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank1_revenue" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">$2,150</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank1_date" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">Sept. 20</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2 text-center w-16" style="height: 55px;">
                                            <p class="font-lilita text-white text-sm md:text-lg text-outline">2ND</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank2_truck" style="width: 1.3em; height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">2</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank2_revenue" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">$2,080</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank2_date" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">Sept. 21</p>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="bg-gray-500 border border-black px-2 py-2 text-center w-16" style="height: 55px;">
                                            <p class="font-lilita text-white text-sm md:text-lg text-outline">3RD</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank3_truck" style="width: 1.3em; height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">3</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank3_revenue" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">$1,980</p>
                                        </td>
                                        <td class="border border-gray-400 px-2 py-2 data-cell" data-sheet="weekly" data-field="rank3_date" style="height: 55px;">
                                            <p class="font-lilita text-white text-xl md:text-2xl text-outline">Sept. 19</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Excel/Google Sheets Integration Script -->
    <script>
        // ============================================
        // EXCEL/GOOGLE SHEETS INTEGRATION GUIDE
        // ============================================
        // 
        // OPTION 1: Google Sheets (Recommended)
        // 1. Upload your Excel file to Google Sheets
        // 2. Share the sheet publicly (View access)
        // 3. Get the Sheet ID from the URL:
        //    https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit
        // 4. Replace 'YOUR_SHEET_ID' below with your actual Sheet ID
        // 5. The sheet should have columns matching the data structure
        //
        // OPTION 2: Excel Online (Office 365)
        // Requires Microsoft Graph API authentication
        //
        // OPTION 3: CSV Export
        // Export Excel to CSV and host it, then fetch via fetchCSV()
        //
        // DATA STRUCTURE EXPECTED:
        // Sheet should have columns for:
        // - Today/Yesterday: Daily Rev, Close Rate, RPH for Trucks 1-5 + Total
        // - Weekly Records: Rank, Truck#, Revenue, Date
        // ============================================

        // ============================================
        // CONFIGURATION - CUSTOMIZE YOUR EXCEL CELL MAPPINGS
        // ============================================
        const CONFIG = {
            // Google Sheets ID (get from URL: docs.google.com/spreadsheets/d/THIS_IS_THE_ID)
            // OR Excel Online URL (see documentation for format)
            googleSheetId: 'YOUR_SHEET_ID_HERE',
            
            // Sheet name (tab name in Google Sheets)
            sheetName: 'Sheet1',
            
            // Auto-refresh interval in milliseconds (60000 = 1 minute)
            // For constantly updated sheets, use 30000 (30 seconds) or 60000 (1 minute)
            refreshInterval: 60000,
            
            // Use dummy data for testing (set to false when ready for live data)
            useDummyData: true,
            
            // Data source type: 'google_sheets' (RECOMMENDED for live updates), 'excel_online', or 'csv_url'
            // NOTE: For LIVE Excel sync, use 'google_sheets' - upload your Excel to Google Sheets
            dataSource: 'google_sheets',
            
            // For Excel Online: Full public URL (if using Excel Online/OneDrive)
            // Get this by: Upload Excel to OneDrive → Share → "Anyone with link can view" → Copy link
            excelOnlineUrl: 'YOUR_ONEDRIVE_SHARE_LINK_HERE',
            
            // For CSV: Direct URL to CSV file (if hosting CSV separately)
            csvUrl: null,

            // ============================================
            // EXCEL CELL MAPPING - Specify which cells to pull from
            // ============================================
            // Use Excel cell notation (A1, B2, C3, etc.)
            // Column A = 1, Column B = 2, Column C = 3, etc.
            // Row 1 = first row, Row 2 = second row, etc.
            // 
            // Example: If your data is in cell B2, use 'B2'
            // Example: If your data is in cell C5, use 'C5'
            // ============================================
            cellMapping: {
                // TODAY'S STATS - Row 2 (Daily Rev), Row 3 (Close Rate), Row 4 (RPH)
                today: {
                    daily_rev: {
                        truck1: 'B2',    // Truck 1 Daily Rev - change to your Excel cell
                        truck2: 'C2',    // Truck 2 Daily Rev - change to your Excel cell
                        truck3: 'D2',    // Truck 3 Daily Rev - change to your Excel cell
                        truck4: 'E2',    // Truck 4 Daily Rev - change to your Excel cell
                        truck5: 'F2',    // Truck 5 Daily Rev - change to your Excel cell
                        total: 'G2'      // Total Daily Rev - change to your Excel cell
                    },
                    close_rate: {
                        truck1: 'B3',    // Truck 1 Close Rate - change to your Excel cell
                        truck2: 'C3',    // Truck 2 Close Rate - change to your Excel cell
                        truck3: 'D3',    // Truck 3 Close Rate - change to your Excel cell
                        truck4: 'E3',    // Truck 4 Close Rate - change to your Excel cell
                        truck5: 'F3',    // Truck 5 Close Rate - change to your Excel cell
                        total: 'G3'      // Total Close Rate - change to your Excel cell
                    },
                    rph: {
                        truck1: 'B4',    // Truck 1 RPH - change to your Excel cell
                        truck2: 'C4',    // Truck 2 RPH - change to your Excel cell
                        truck3: 'D4',    // Truck 3 RPH - change to your Excel cell
                        truck4: 'E4',    // Truck 4 RPH - change to your Excel cell
                        truck5: 'F4',    // Truck 5 RPH - change to your Excel cell
                        total: 'G4'      // Total RPH - change to your Excel cell
                    }
                },
                // YESTERDAY'S STATS - Adjust row numbers to match your Excel
                yesterday: {
                    daily_rev: {
                        truck1: 'B6',    // Truck 1 Daily Rev (Yesterday) - change to your Excel cell
                        truck2: 'C6',    // Truck 2 Daily Rev (Yesterday) - change to your Excel cell
                        truck3: 'D6',    // Truck 3 Daily Rev (Yesterday) - change to your Excel cell
                        truck4: 'E6',    // Truck 4 Daily Rev (Yesterday) - change to your Excel cell
                        truck5: 'F6',    // Truck 5 Daily Rev (Yesterday) - change to your Excel cell
                        total: 'G6'      // Total Daily Rev (Yesterday) - change to your Excel cell
                    },
                    close_rate: {
                        truck1: 'B7',    // Truck 1 Close Rate (Yesterday) - change to your Excel cell
                        truck2: 'C7',    // Truck 2 Close Rate (Yesterday) - change to your Excel cell
                        truck3: 'D7',    // Truck 3 Close Rate (Yesterday) - change to your Excel cell
                        truck4: 'E7',    // Truck 4 Close Rate (Yesterday) - change to your Excel cell
                        truck5: 'F7',    // Truck 5 Close Rate (Yesterday) - change to your Excel cell
                        total: 'G7'      // Total Close Rate (Yesterday) - change to your Excel cell
                    },
                    rph: {
                        truck1: 'B8',    // Truck 1 RPH (Yesterday) - change to your Excel cell
                        truck2: 'C8',    // Truck 2 RPH (Yesterday) - change to your Excel cell
                        truck3: 'D8',    // Truck 3 RPH (Yesterday) - change to your Excel cell
                        truck4: 'E8',    // Truck 4 RPH (Yesterday) - change to your Excel cell
                        truck5: 'F8',    // Truck 5 RPH (Yesterday) - change to your Excel cell
                        total: 'G8'      // Total RPH (Yesterday) - change to your Excel cell
                    }
                },
                // WEEKLY RECORDS - Adjust to match your Excel structure
                weekly: {
                    rank1_truck: 'B11',      // 1st place truck number - change to your Excel cell
                    rank1_revenue: 'C11',    // 1st place revenue - change to your Excel cell
                    rank1_date: 'D11',       // 1st place date - change to your Excel cell
                    rank2_truck: 'B12',      // 2nd place truck number - change to your Excel cell
                    rank2_revenue: 'C12',    // 2nd place revenue - change to your Excel cell
                    rank2_date: 'D12',       // 2nd place date - change to your Excel cell
                    rank3_truck: 'B13',      // 3rd place truck number - change to your Excel cell
                    rank3_revenue: 'C13',    // 3rd place revenue - change to your Excel cell
                    rank3_date: 'D13'        // 3rd place date - change to your Excel cell
                }
            }
        };

        /**
         * Update a single cell with new data
         */
        function updateCell(selector, value, format = 'text') {
            const cell = document.querySelector(selector);
            if (!cell) return;

            const pTag = cell.querySelector('p');
            if (!pTag) return;

            // Format the value based on type
            let formattedValue = value;
            if (format === 'currency') {
                formattedValue = `$${parseFloat(value).toLocaleString()}`;
            } else if (format === 'percent') {
                formattedValue = `${parseFloat(value)}%`;
            } else if (format === 'date') {
                formattedValue = value; // Assume date is already formatted
            }

            pTag.textContent = formattedValue;
        }

        /**
         * Update all cells from a data object
         */
        function updateAllCells(data) {
            // Update Today's stats
            if (data.today) {
                Object.keys(data.today).forEach(metric => {
                    Object.keys(data.today[metric]).forEach(truck => {
                        const selector = `.data-cell[data-sheet="today"][data-metric="${metric}"][data-truck="${truck}"]`;
                        const value = data.today[metric][truck];
                        const format = metric === 'daily_rev' || metric === 'rph' ? 'currency' : 'percent';
                        updateCell(selector, value, format);
                    });
                });
            }

            // Update Yesterday's stats
            if (data.yesterday) {
                Object.keys(data.yesterday).forEach(metric => {
                    Object.keys(data.yesterday[metric]).forEach(truck => {
                        const selector = `.data-cell[data-sheet="yesterday"][data-metric="${metric}"][data-truck="${truck}"]`;
                        const value = data.yesterday[metric][truck];
                        const format = metric === 'daily_rev' || metric === 'rph' ? 'currency' : 'percent';
                        updateCell(selector, value, format);
                    });
                });
            }

            // Update Weekly records
            if (data.weekly) {
                Object.keys(data.weekly).forEach(field => {
                    const selector = `.data-cell[data-sheet="weekly"][data-field="${field}"]`;
                    const value = data.weekly[field];
                    let format = 'text';
                    if (field.includes('revenue')) format = 'currency';
                    if (field.includes('date')) format = 'date';
                    updateCell(selector, value, format);
                });
            }
        }

        /**
         * Fetch data from Google Sheets with cache-busting for constantly updated sheets
         * Requires: Public sheet
         */
        async function fetchFromGoogleSheets() {
            if (!CONFIG.googleSheetId || CONFIG.googleSheetId === 'YOUR_SHEET_ID_HERE') {
                console.warn('Google Sheet ID not configured');
                return null;
            }

            try {
                // Using CSV export with cache-busting timestamp to ensure fresh data
                // This prevents browser caching and ensures we get the latest updates
                const timestamp = new Date().getTime();
                const csvUrl = `https://docs.google.com/spreadsheets/d/${CONFIG.googleSheetId}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(CONFIG.sheetName)}&t=${timestamp}`;
                
                // Add no-cache headers to ensure fresh data
                const response = await fetch(csvUrl, {
                    method: 'GET',
                    cache: 'no-store',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const csvText = await response.text();
                
                // Parse CSV and convert to data structure
                // Handle quoted values properly
                const rows = parseCSV(csvText);
                return parseCSVToData(rows);
                
            } catch (error) {
                console.error('Error fetching from Google Sheets:', error);
                return null;
            }
        }

        /**
         * Fetch data from Excel Online (OneDrive/SharePoint)
         * Requires: Public Excel file shared via OneDrive or SharePoint
         * 
         * IMPORTANT: For LIVE updates, use Google Sheets instead (recommended).
         * Excel Online requires the file to be exported to CSV format for direct access.
         * 
         * For true live Excel sync:
         * 1. Upload your Excel to Google Sheets (File → Import → Upload)
         * 2. Use the Google Sheets option with the Sheet ID
         * 3. Your Excel changes will sync when you re-import, or just edit Google Sheets directly
         */
        async function fetchFromExcelOnline() {
            if (!CONFIG.excelOnlineUrl || CONFIG.excelOnlineUrl === 'YOUR_ONEDRIVE_SHARE_LINK_HERE') {
                console.warn('Excel Online URL not configured');
                return null;
            }

            try {
                let csvUrl = CONFIG.excelOnlineUrl;
                
                // Handle different OneDrive/SharePoint URL formats
                // Format 1: https://onedrive.live.com/embed?resid=FILE_ID&authkey=KEY
                if (csvUrl.includes('onedrive.live.com/embed')) {
                    const fileIdMatch = csvUrl.match(/resid=([^&]+)/);
                    const authKeyMatch = csvUrl.match(/authkey=([^&]+)/);
                    
                    if (fileIdMatch) {
                        const fileId = fileIdMatch[1];
                        const authKey = authKeyMatch ? authKeyMatch[1] : '';
                        // Convert to download URL - but Excel files need to be CSV
                        csvUrl = `https://onedrive.live.com/download?resid=${fileId}${authKey ? '&authkey=' + authKey : ''}`;
                    }
                }
                // Format 2: https://1drv.ms/x/s!FILE_ID (short link) - needs expansion
                else if (csvUrl.includes('1drv.ms')) {
                    console.warn('Short OneDrive links (1drv.ms) need to be converted. Please use the full share link or convert to CSV.');
                    // Try to use as-is, but may not work
                }
                // Format 3: SharePoint Online
                else if (csvUrl.includes('sharepoint.com')) {
                    // SharePoint URLs need special handling
                    // Convert to direct download format if possible
                    if (csvUrl.includes('/_layouts/15/download.aspx')) {
                        // Already a download URL
                    } else if (csvUrl.includes('/_layouts/15/WopiFrame.aspx')) {
                        // Convert SharePoint view URL to download
                        const siteMatch = csvUrl.match(/sourcedoc=([^&]+)/);
                        if (siteMatch) {
                            csvUrl = csvUrl.replace('/_layouts/15/WopiFrame.aspx', '/_layouts/15/download.aspx');
                        }
                    }
                }
                // Format 4: Direct CSV download link (best option)
                // If URL already points to CSV, use it as-is
                
                // Add cache-busting for live updates
                const timestamp = new Date().getTime();
                const separator = csvUrl.includes('?') ? '&' : '?';
                csvUrl += `${separator}_t=${timestamp}`;
                
                const response = await fetch(csvUrl, {
                    method: 'GET',
                    cache: 'no-store',
                    mode: 'cors',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });
                
                if (!response.ok) {
                    // If Excel file doesn't download as CSV, provide helpful error
                    const contentType = response.headers.get('content-type') || '';
                    if (contentType.includes('application/vnd') || contentType.includes('spreadsheetml')) {
                        throw new Error('Excel file format detected. For LIVE updates, please:\n' +
                            '1. Export Excel to CSV and use that URL, OR\n' +
                            '2. Upload Excel to Google Sheets and use Google Sheets option (RECOMMENDED for live sync)');
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const csvText = await response.text();
                
                // Check if we actually got CSV or HTML (login page or error)
                if (csvText.trim().startsWith('<!DOCTYPE') || csvText.includes('<html') || csvText.includes('Sign in')) {
                    throw new Error('Received HTML instead of CSV. Make sure:\n' +
                        '1. Your Excel file is shared as "Anyone with the link can view"\n' +
                        '2. Export your Excel file to CSV format first\n' +
                        '3. Or use Google Sheets for better live sync support');
                }
                
                const rows = parseCSV(csvText);
                return parseCSVToData(rows);
                
            } catch (error) {
                console.error('Error fetching from Excel Online:', error);
                console.error('\n=== RECOMMENDED SOLUTION FOR LIVE EXCEL SYNC ===');
                console.error('For constantly updated Excel files, use Google Sheets:');
                console.error('1. Go to Google Sheets (sheets.google.com)');
                console.error('2. File → Import → Upload your Excel file');
                console.error('3. Share the sheet publicly (Anyone with link can view)');
                console.error('4. Get the Sheet ID from the URL');
                console.error('5. Update CONFIG in index.html:');
                console.error('   - Set googleSheetId to your Sheet ID');
                console.error('   - Set dataSource to "google_sheets"');
                console.error('   - Set useDummyData to false');
                console.error('6. Your website will auto-refresh every 30-60 seconds with live data!');
                return null;
            }
        }

        /**
         * Fetch data from direct CSV URL
         */
        async function fetchFromCSV() {
            if (!CONFIG.csvUrl) {
                console.warn('CSV URL not configured');
                return null;
            }

            try {
                const timestamp = new Date().getTime();
                const separator = CONFIG.csvUrl.includes('?') ? '&' : '?';
                const csvUrl = `${CONFIG.csvUrl}${separator}_t=${timestamp}`;
                
                const response = await fetch(csvUrl, {
                    method: 'GET',
                    cache: 'no-store',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const csvText = await response.text();
                const rows = parseCSV(csvText);
                return parseCSVToData(rows);
                
            } catch (error) {
                console.error('Error fetching from CSV:', error);
                return null;
            }
        }

        /**
         * Parse CSV text into rows, handling quoted values
         */
        function parseCSV(csvText) {
            const rows = [];
            const lines = csvText.split('\n');
            
            for (let line of lines) {
                if (!line.trim()) continue;
                
                const row = [];
                let current = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    const nextChar = line[i + 1];
                    
                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            current += '"';
                            i++; // Skip next quote
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        row.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                
                row.push(current.trim()); // Add last field
                rows.push(row);
            }
            
            return rows;
        }

        /**
         * Convert Excel cell notation (A1, B2, etc.) to row/column indices
         * A1 = row 0, col 0
         * B2 = row 1, col 1
         * Returns: { row: number, col: number } or null if invalid
         */
        function parseCellReference(cellRef) {
            if (!cellRef || typeof cellRef !== 'string') return null;
            
            // Match pattern like A1, B2, AA10, etc.
            const match = cellRef.match(/^([A-Z]+)(\d+)$/i);
            if (!match) return null;
            
            const colLetters = match[1].toUpperCase();
            const rowNumber = parseInt(match[2], 10);
            
            // Convert column letters to number (A=0, B=1, Z=25, AA=26, etc.)
            let colNumber = 0;
            for (let i = 0; i < colLetters.length; i++) {
                colNumber = colNumber * 26 + (colLetters.charCodeAt(i) - 64);
            }
            colNumber -= 1; // Convert to 0-based index
            
            // Convert row number to 0-based index
            const rowIndex = rowNumber - 1;
            
            return { row: rowIndex, col: colNumber };
        }

        /**
         * Get value from CSV rows using Excel cell reference (A1, B2, etc.)
         */
        function getCellValue(rows, cellRef) {
            const cell = parseCellReference(cellRef);
            if (!cell) {
                console.warn(`Invalid cell reference: ${cellRef}`);
                return '0';
            }
            
            const row = rows[cell.row];
            if (!row) {
                console.warn(`Row ${cell.row} (from ${cellRef}) not found in data`);
                return '0';
            }
            
            const value = row[cell.col];
            if (value === undefined || value === null || value === '') {
                console.warn(`Cell ${cellRef} (row ${cell.row}, col ${cell.col}) is empty`);
                return '0';
            }
            
            // Remove quotes and clean up the value
            return String(value).trim().replace(/^["']|["']$/g, '');
        }

        /**
         * Parse CSV rows into the expected data structure using cell mapping from CONFIG
         * This uses the Excel cell references you specify in CONFIG.cellMapping
         */
        function parseCSVToData(rows) {
            const mapping = CONFIG.cellMapping;
            
            return {
                today: {
                    daily_rev: {
                        truck1: getCellValue(rows, mapping.today.daily_rev.truck1),
                        truck2: getCellValue(rows, mapping.today.daily_rev.truck2),
                        truck3: getCellValue(rows, mapping.today.daily_rev.truck3),
                        truck4: getCellValue(rows, mapping.today.daily_rev.truck4),
                        truck5: getCellValue(rows, mapping.today.daily_rev.truck5),
                        total: getCellValue(rows, mapping.today.daily_rev.total)
                    },
                    close_rate: {
                        truck1: getCellValue(rows, mapping.today.close_rate.truck1),
                        truck2: getCellValue(rows, mapping.today.close_rate.truck2),
                        truck3: getCellValue(rows, mapping.today.close_rate.truck3),
                        truck4: getCellValue(rows, mapping.today.close_rate.truck4),
                        truck5: getCellValue(rows, mapping.today.close_rate.truck5),
                        total: getCellValue(rows, mapping.today.close_rate.total)
                    },
                    rph: {
                        truck1: getCellValue(rows, mapping.today.rph.truck1),
                        truck2: getCellValue(rows, mapping.today.rph.truck2),
                        truck3: getCellValue(rows, mapping.today.rph.truck3),
                        truck4: getCellValue(rows, mapping.today.rph.truck4),
                        truck5: getCellValue(rows, mapping.today.rph.truck5),
                        total: getCellValue(rows, mapping.today.rph.total)
                    }
                },
                yesterday: {
                    daily_rev: {
                        truck1: getCellValue(rows, mapping.yesterday.daily_rev.truck1),
                        truck2: getCellValue(rows, mapping.yesterday.daily_rev.truck2),
                        truck3: getCellValue(rows, mapping.yesterday.daily_rev.truck3),
                        truck4: getCellValue(rows, mapping.yesterday.daily_rev.truck4),
                        truck5: getCellValue(rows, mapping.yesterday.daily_rev.truck5),
                        total: getCellValue(rows, mapping.yesterday.daily_rev.total)
                    },
                    close_rate: {
                        truck1: getCellValue(rows, mapping.yesterday.close_rate.truck1),
                        truck2: getCellValue(rows, mapping.yesterday.close_rate.truck2),
                        truck3: getCellValue(rows, mapping.yesterday.close_rate.truck3),
                        truck4: getCellValue(rows, mapping.yesterday.close_rate.truck4),
                        truck5: getCellValue(rows, mapping.yesterday.close_rate.truck5),
                        total: getCellValue(rows, mapping.yesterday.close_rate.total)
                    },
                    rph: {
                        truck1: getCellValue(rows, mapping.yesterday.rph.truck1),
                        truck2: getCellValue(rows, mapping.yesterday.rph.truck2),
                        truck3: getCellValue(rows, mapping.yesterday.rph.truck3),
                        truck4: getCellValue(rows, mapping.yesterday.rph.truck4),
                        truck5: getCellValue(rows, mapping.yesterday.rph.truck5),
                        total: getCellValue(rows, mapping.yesterday.rph.total)
                    }
                },
                weekly: {
                    rank1_truck: getCellValue(rows, mapping.weekly.rank1_truck),
                    rank1_revenue: getCellValue(rows, mapping.weekly.rank1_revenue),
                    rank1_date: getCellValue(rows, mapping.weekly.rank1_date),
                    rank2_truck: getCellValue(rows, mapping.weekly.rank2_truck),
                    rank2_revenue: getCellValue(rows, mapping.weekly.rank2_revenue),
                    rank2_date: getCellValue(rows, mapping.weekly.rank2_date),
                    rank3_truck: getCellValue(rows, mapping.weekly.rank3_truck),
                    rank3_revenue: getCellValue(rows, mapping.weekly.rank3_revenue),
                    rank3_date: getCellValue(rows, mapping.weekly.rank3_date)
                }
            };
        }

        /**
         * Load dummy data for testing
         */
        function loadDummyData() {
            const dummyData = {
                today: {
                    daily_rev: {
                        truck1: '1250',
                        truck2: '1450',
                        truck3: '1380',
                        truck4: '1320',
                        truck5: '1560',
                        total: '6960'
                    },
                    close_rate: {
                        truck1: '68',
                        truck2: '72',
                        truck3: '70',
                        truck4: '65',
                        truck5: '75',
                        total: '70'
                    },
                    rph: {
                        truck1: '156',
                        truck2: '181',
                        truck3: '172',
                        truck4: '165',
                        truck5: '195',
                        total: '174'
                    }
                },
                yesterday: {
                    daily_rev: {
                        truck1: '1180',
                        truck2: '1350',
                        truck3: '1420',
                        truck4: '1290',
                        truck5: '1480',
                        total: '6720'
                    },
                    close_rate: {
                        truck1: '65',
                        truck2: '70',
                        truck3: '71',
                        truck4: '64',
                        truck5: '74',
                        total: '69'
                    },
                    rph: {
                        truck1: '147',
                        truck2: '169',
                        truck3: '178',
                        truck4: '161',
                        truck5: '185',
                        total: '168'
                    }
                },
                weekly: {
                    rank1_truck: '5',
                    rank1_revenue: '2150',
                    rank1_date: 'Sept. 20',
                    rank2_truck: '2',
                    rank2_revenue: '2080',
                    rank2_date: 'Sept. 21',
                    rank3_truck: '3',
                    rank3_revenue: '1980',
                    rank3_date: 'Sept. 19'
                }
            };
            updateAllCells(dummyData);
        }

        /**
         * Main function to load data from configured source
         */
        async function loadData() {
            if (CONFIG.useDummyData) {
                loadDummyData();
                return;
            }

            let data = null;

            // Fetch from the configured data source
            switch (CONFIG.dataSource) {
                case 'google_sheets':
                    data = await fetchFromGoogleSheets();
                    break;
                case 'excel_online':
                    data = await fetchFromExcelOnline();
                    break;
                case 'csv_url':
                    data = await fetchFromCSV();
                    break;
                default:
                    console.warn('Unknown data source:', CONFIG.dataSource);
                    data = await fetchFromGoogleSheets(); // Fallback
            }

            if (data) {
                updateAllCells(data);
                console.log('Data updated successfully at', new Date().toLocaleTimeString());
            } else {
                console.warn('Could not load data, using dummy data');
                loadDummyData();
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            
            // Set up auto-refresh if enabled
            if (CONFIG.refreshInterval > 0 && !CONFIG.useDummyData) {
                setInterval(loadData, CONFIG.refreshInterval);
            }
        });
    </script>
</body>
</html>
